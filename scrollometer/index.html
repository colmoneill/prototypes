<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta NAME="KEYWORDS" CONTENT="Actual Size Ruler">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Scroll meter prototype - mm,cm,inch</title>
    <link rel="stylesheet" href="styles.css">
    <script src="script.js"></script>
  </head>

  <body>
  <div id="mainbody">
  <h1>Scroll-meter prototype homepage</h1>

  <p><b>Scrolling is an achievement! Be proud of your metrics!</b><br>
  How can we grasp physical world units on screens? How can I print a centimeter on the screen. How can I make sure the centimeter will remain a centimeter across all types of screens?</p>

  <p>We know screens are just grids of pixels, but what is less easy is to find out how many pixels are on the panel. If you know the physical measurements of the screen, and the screen resolution in pixels, then we can work out the pixel density. Reminiscents of the print world call this number PPI, points per inch, in this case pixels per inch, effectively the same notion.</p>

  <h2>pixels per inch</h2>
  <p>If we know a screen's PPI, (in my case I'll rather a PP-centimeter) we can make rules to draw and display real centimeters. Keep in mind that this won't ever be perfectly precise, grids of pixels in pannels don't constrain to a rhythmical finish, and we can't exactly turn halfs or quarter pixels on or off.</p>

  <p>use case: my personal laptop screen. My laptop has a 'wide screen' (13.6"x7.6"),
  and resolution is 1366x768 pixels, 1366 / 13.6 = 100.44 PPI. Granted, you could also simply search for your exact device online and discover your PPI this way</p>

  <h2>theoretical usage</h2>
  <p>So the rule would look like this
  <ul>
    <li>in a css preprocessor variable definition sheet :<br>
    <code>
    var ppi = 100.44;<br>
    var ppcm = (ppi * 2.54 /* 1 cm = 2.54 in */);<br>
    var realcm = ppcm<br>
    </code>
    <br>then in use :<br>
    <code>
      div.tenCm{<br>
        width: (10*realcm) px;<br>
      }<br>
    </code>
    </li>
  </ul>
  </p>

  <h2>devicePixelRatio</h2>
  <h3>vocabulary</h3>
  <p>notions that need defining: <br>
  <ul>
    <li>physical pixels</li>
    <li>dips, device independent pixels</li>
    <li>device pixel Ratio</li>
  </ul>
  references:<br>
  http://www.quirksmode.org/blog/archives/2012/06/devicepixelrati.html<br>
  http://www.quirksmode.org/blog/archives/2012/07/more_about_devi.html<br>
  </p>


  <p>
  <h2>CSS pretends</h2>
  CSS does have cm, inches, points and picas, all physical world set units, but they never worked out. Next are three css only examples, on css inch, one css centimeter, and one css pixel.

<div class="inch-tester"></div>
<div class="cm-tester"></div>
<div class="pixel-tester"></div>

  </p>


<h1 class="pagetitle">Actual Size Ruler</h1>

<canvas id="ruler" width="680" height="130" style="border:1px solid #838383;">
Your browser does not support the canvas element.
</canvas>
<script>
var isDragging=false;
var DDX=0;
var DSV=0;
function handleMouseDown(e){
  if(document.getElementById("adjuster").value!=''){
    isDragging=true;DDX=e.clientX;
    DSV=document.getElementById("ppi").value;
    }
  }
function handleMouseUp(e){isDragging=false;}
function handleMouseOut(e){isDragging=false;}
function handleMouseMove(e){
  if((isDragging)&&(document.getElementById("adjuster").value!='')){
    var MouseX=parseInt(e.clientX-DDX);
    document.getElementById("ppi").value=parseFloat(DSV)+MouseX/10;
    drawruler();
    drawAdjuster();
  }
}

var c=document.getElementById("ruler");
c.addEventListener("mousedown", handleMouseDown);
c.addEventListener("mouseup", handleMouseUp);
c.addEventListener("mouseout", handleMouseOut);
c.addEventListener("mousemove", handleMouseMove);
var rulers= ["","A4 Paper (portrait)","A4 Paper (landscape)","20 EURO Note (long)"];
var rulers_inch= [0,8.264,11.681,5.236];
</script>

<form>
<p>
<!--
Graduation of an inch: <select id="fractions" onchange="drawruler();"><option value="8">1/8</option>
<option value="16" selected="selected">1/16</option><option value="32">1/32</option></select> ",
<input type="checkbox" id="mark18" value="1" onchange="drawruler();"><label for="mark18">show 1/8" markings</label>
-->
<div id="btnAdjust" style="display:none">
  Ruler Adjuster : <input type="button" value="Smaller" onclick="changeppi(-0.1);" class="btnAdjuster">
<input type="button" value="Bigger" onclick="changeppi(0.1);" class="btnAdjuster">
<script type="text/javascript">
function refrest_btnAdjust(){
var a=document.getElementById('adjuster');
var b=document.getElementById('btnAdjust');
if (a.value>0){b.style.display='block';}else {b.style.display='none';}
}
function changeppi(f){
var ppi=document.getElementById('ppi');
ppi.value=parseFloat(ppi.value)+f;
drawruler();
drawAdjuster();
}
</script>

</div>
</p>
</form>

<h2 id="h2_title">Real size onscreen Ruler</h2>
<p id="h2_p">Adjustable (<b>draggable</b>) online vitrual ruler that can be <em>adjusted to an actual physical work size</em>.
</p>


<h3 id="h3_title">Adjusting this virtual ruler to actual size </h3>
<p>Select an object out of the list that you can lay your hands on.</p>
<form>
<p>Save the pixels per inch (PPI) according your own device, then you can use this next time.
<br><strong>Pixels per inch :</strong> <input id="ppi" type="text" size="5" value="100.7">
, show ruler adjuster <select id="adjuster" onchange="refrest_btnAdjust();drawAdjuster();">
<option value=""></option>
<script>

for (i=1;i<rulers.length;i++){
document.write("<option value="+i+">"+ rulers[i]+"</option>");
}
</script>
</select>
<br>
 <input type="button" value="Save PPI Setting" onclick="save();" class="btn">
 <input type="button" value="Restore to Default PPI" onclick="restore();" class="btn">
</p>
</form>

<p>
Dragging ruler adjuster left or right to fit the size of the reference,
remember to save the setting for next time,
after save the setting, refresh your brower to check the result.
On the most popular browsers you can press the F5 key or click on the refresh button.
</p>







<script type="text/javascript">
function gel(id){return document.getElementById(id);}
function setCookie(c_name,value,exdays)
{
var exdate=new Date();
exdate.setDate(exdate.getDate() + exdays);
var c_value=escape(value) + ((exdays==null) ? "" : "; expires="+exdate.toUTCString());
document.cookie=c_name + "=" + c_value;
}
function getCookie(c_name)
{
var i,x,y,ARRcookies=document.cookie.split(";");
for (i=0;i<ARRcookies.length;i++)
  {
  x=ARRcookies[i].substr(0,ARRcookies[i].indexOf("="));
  y=ARRcookies[i].substr(ARRcookies[i].indexOf("=")+1);
  x=x.replace(/^\s+|\s+$/g,"");
  if (x==c_name)
    {
    return unescape(y);
    }
  }
}
function cal(t){
if (t==gel('mm')){
gel('cm').value=t.value/10;
gel('inch').value=Math.round(t.value/25.4*100)/100;
} else if (t==gel('cm')){
gel('mm').value=t.value*10;
gel('inch').value=Math.round(t.value/2.54*100)/100;
} else if (t==gel('inch')){
gel('mm').value=Math.round(t.value*25.4*10)/10;
gel('cm').value=Math.round(t.value*2.54*100)/100;
}
var inch=gel('inch').value;
var fractions=gel('fractions').value;
var fra_in=Math.floor(inch);
numerator=Math.round((inch-fra_in)/(1/fractions));
denominator=fractions;
while((numerator%2==0)&&((denominator%2==0))){numerator/=2;denominator/=2;}
if(numerator==1 && denominator==1){fra_in+=1;numerator=0;}
if(fra_in>0){sTemp=fra_in;} else {sTemp='';}
if(numerator>0){if(fra_in>0){sTemp+=' ';}sTemp+=numerator + '/' + denominator + '"'}
else {sTemp+='"';}
gel('msg').innerHTML= gel('mm').value + ' MM = ' + gel('cm').value + ' CM = '
+ gel('inch').value + ' inches = ' + sTemp;

drawruler();
if (!isNaN(gel('cm').value)){
 drawmark(gel('cm').value*ppcm);
}

}

if (typeof(localStorage)!=="undefined") {
  if (localStorage.getItem("pixels_per_inch")!==null){
    gel('ppi').value=localStorage.getItem("pixels_per_inch");
  }
} else if ((getCookie('ppi')!='') && ( parseFloat(getCookie('ppi'))>50 )){
  gel('ppi').value=getCookie('ppi');
}

var dpi_x=100.7;
var ppcm=dpi_x/2.54;
var c=document.getElementById("ruler");
if (screen.width>800){c.width=screen.width-40; } else {c.width=screen.width-20; }
var cxt=c.getContext("2d");
var w=c.clientWidth;
var begin_x=20;
var BL_cm=0.5;
var BL_inch=129.5;

function drawruler(){
if ((gel("ppi").value!='') && (parseFloat(gel("ppi").value)>50)){dpi_x=parseFloat(gel("ppi").value);}
else {gel("ppi").value==dpi_x;}
if ((dpi_x<50) || (isNaN(dpi_x))) {dpi_x=100.7;}
ppcm=dpi_x/2.54;

cxt.setTransform(1, 0, 0, 1, 0, 0);
cxt.clearRect(0, 0, c.width, c.height);
//ruler for cm
cxt.strokeStyle ='#000000';
cxt.fillStyle ='#000000';
cxt.lineWidth=1;
cxt.beginPath();
cxt.moveTo(0,BL_cm);
cxt.lineTo(w,BL_cm);
cxt.stroke();

for(i=begin_x,j=0;i<=w;i=i+ppcm,j++){
Lh=BL_cm+35;
cxt.beginPath();
cxt.lineWidth=1;
cxt.moveTo(i,Lh);
cxt.lineTo(i,BL_cm);
cxt.stroke();
cxt.font = "20px monospace";
if (j<10){ cxt.fillText(j,i-6,Lh+20);
} else {cxt.fillText(j,i-11,Lh+20);}

}

s2=ppcm/2;
for(i=begin_x,j=0;i<=w;i=i+s2,j++){
if (j%2==0) continue;
Lh=BL_cm+25;
cxt.beginPath();
cxt.lineWidth=1;
cxt.moveTo(i,Lh);
cxt.lineTo(i,BL_cm);
cxt.stroke();
}

s10=ppcm/10;
for(i=begin_x,j=0;i<=w;i=i+s10,j++){
if ((j%5==0)||(j%10==0)) continue;
Lh=BL_cm+15;
cxt.beginPath();
cxt.lineWidth=1;
cxt.moveTo(i,Lh);
cxt.lineTo(i,BL_cm);
cxt.stroke();
}

//ruler for inch
cxt.strokeStyle ='#000000';//线条颜色
cxt.fillStyle="#000000";
cxt.lineWidth=1;//设置线宽
cxt.beginPath();
cxt.moveTo(0,BL_inch);
cxt.lineTo(w,BL_inch);
cxt.stroke();//画线框

for(i=begin_x,j=0;i<=w;i=i+dpi_x,j++){
Lh=BL_inch-35;
cxt.beginPath();
cxt.lineWidth=1;
cxt.moveTo(i,Lh);
cxt.lineTo(i,BL_inch);
cxt.stroke();
cxt.font = "20px monospace";
if (j<10){cxt.fillText(j,i-6,Lh-5);}
else {cxt.fillText(j,i-12,Lh-5);}
}

s2=dpi_x/2;
for(i=begin_x,j=0;i<=w;i=i+s2,j++){
if (j%2==0) continue;
Lh=BL_inch-30;
cxt.beginPath();
cxt.lineWidth=1;
cxt.moveTo(i,Lh);
cxt.lineTo(i,BL_inch);
cxt.stroke();
cxt.font = "16px monospace";
cxt.fillText('½',i-7,Lh-5);
}

s4=dpi_x/4;
for(i=begin_x,j=0;i<=w;i=i+s4,j++){
if ((j%2==0)||(j%4==0)) continue;
Lh=BL_inch-25;
cxt.beginPath();
cxt.lineWidth=1;
cxt.moveTo(i,Lh);
cxt.lineTo(i,BL_inch);
cxt.stroke();
cxt.font = "12px monospace";
if (j%4==1){ cxt.fillText('¼',i-7,Lh-5);}
else if (j%4==3){ cxt.fillText('¾',i-7,Lh-5);}
}

s8=dpi_x/8;
for(i=begin_x,j=0;i<=w;i=i+s8,j++){
if ((j%2==0)||(j%4==0)) continue;
Lh=BL_inch-18;
cxt.beginPath();
cxt.lineWidth=1;
cxt.moveTo(i,Lh);
cxt.lineTo(i,BL_inch);
cxt.stroke();
if (gel('mark18').checked == true){
cxt.save();
cxt.font = "12px monospace";
cxt.scale(0.8,1);
if (j%8==1){ cxt.fillText('⅛',(i-7)/0.8,Lh-1);}
else if (j%8==3){ cxt.fillText('⅜',(i-6)/0.8,Lh-1);}
else if (j%8==5){ cxt.fillText('⅝',(i-6)/0.8,Lh-1);}
else if (j%8==7){ cxt.fillText('⅞',(i-6)/0.8,Lh-1);}
cxt.restore();
}

}

if (gel('fractions').value > 8){
s16=dpi_x/16;
for(i=begin_x,j=0;i<=w;i=i+s16,j++){
if ((j%2==0)||(j%4==0)||(j%8==0)) continue;
Lh=BL_inch-15;
cxt.beginPath();
cxt.lineWidth=1;
cxt.moveTo(i,Lh);
cxt.lineTo(i,BL_inch);
cxt.stroke();
}
}

if (gel('fractions').value > 16){
s32=dpi_x/32;
for(i=begin_x,j=0;i<=w;i=i+s32,j++){
if ((j%2==0)||(j%4==0)||(j%8==0)||(j%16==0)) continue;
Lh=BL_inch-10;
cxt.beginPath();
cxt.lineWidth=1;
cxt.moveTo(i,Lh);
cxt.lineTo(i,BL_inch);
cxt.stroke();
}
}
cxt.save();
cxt.translate(0,0);
cxt.rotate(90 * Math.PI / 180);
cxt.font="12px monospace";
cxt.fillText('MM CM', 3, -2);
cxt.fillText("INCH", 94, -2);
cxt.restore();
cxt.closePath();
}

function drawmark(px){
cxt.strokeStyle ='#FF0000';
cxt.lineWidth=1;
cxt.beginPath();
cxt.moveTo(begin_x+px,0);
cxt.lineTo(begin_x+px,130);
cxt.stroke();

}

function drawAdjuster(){
var a=document.getElementById("adjuster");
var ppiv=document.getElementById("ppi").value;

//clear
cxt.beginPath();
cxt.clearRect(begin_x-1,59,c.clientWidth,13);
cxt.stroke();

if (a.value>0){
var w=ppiv*rulers_inch[a.value];
cxt.strokeStyle ='#FF0000';
cxt.fillStyle="#FF0000";
cxt.font="12px monospace";
cxt.lineWidth=1;
cxt.beginPath();
cxt.moveTo(begin_x,60);
cxt.lineTo(begin_x,70);
cxt.moveTo(begin_x,65);
cxt.lineTo(begin_x+w,65);
cxt.moveTo(begin_x+w,60);
cxt.lineTo(begin_x+w,70);
cxt.stroke();
cxt.beginPath();
cxt.clearRect(begin_x+(w/2)-60,60,170,10);
cxt.fillText(rulers[a.value],begin_x+(w/2)-40,70);
cxt.stroke();
}
}

function save(){
  if ( (typeof(Storage)!=="undefined") ) {
    localStorage.setItem("pixels_per_inch",gel('ppi').value);
    alert('Save - Pixels per inch : ' + localStorage.getItem("pixels_per_inch"));
  } else {
    setCookie('ppi',gel('ppi').value,365);
    alert('Save - Pixels per inch : ' + getCookie('ppi'));
  }
  drawruler();
}

function restore(){
  setCookie('ppi','',-1);
  localStorage.removeItem("pixels_per_inch");
  gel('ppi').value='100.7';
  drawruler();
}

drawruler();
</script>
